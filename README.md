# Hexo 博客管理工具

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.6%2B-blue.svg">
  <img src="https://img.shields.io/badge/Tkinter-GUI-orange.svg">
  <img src="https://img.shields.io/badge/Hexo-管理工具-green.svg">
  <img src="https://img.shields.io/badge/Markdown-支持-yellow.svg">
</p>

这是一个功能完善的 Hexo 博客管理工具，提供图形化界面来管理 Hexo 博客文章，无需修改您的 Hexo 项目本身。通过文件读取的方式，您可以方便地创建、编辑、删除博客文章，并执行 Hexo 相关命令，极大地简化了 Hexo 博客的管理流程。

## 功能特点

### 文章管理
- 📝 **新建文章**：快速创建新的博客文章，自动生成符合 Hexo 格式的文件
- ✏️ **编辑文章**：便捷编辑现有文章，支持 Markdown 语法高亮
- 🗑️ **删除文章**：安全删除不需要的文章
- 📋 **文章列表**：按日期排序展示所有文章，支持快速筛选和查找
- 🔄 **刷新列表**：实时更新文章列表

### 增强的 Markdown 编辑功能
- **基础格式化**：粗体、斜体、标题（1-6级）、引用、分割线、链接
- **列表功能**：
  - 无序列表（`*`, `-`, `+` 符号）
  - 有序列表（数字序号）
  - 任务列表（复选框风格）
- **表格支持**：通过对话框自定义行数和列数，快速插入表格
- **代码相关**：代码块（支持语言高亮）、行内代码
- **其他格式**：删除线、图片插入、预览功能

### Hexo 命令执行
- 🚀 **启动本地服务器**：智能检测端口占用情况，支持自定义端口选择
- 🏗️ **生成静态文件**：执行 `hexo g` 命令生成静态网站
- 🧹 **清理缓存**：执行 `hexo clean` 清理 Hexo 缓存文件
- 📤 **部署网站**：执行 `hexo d` 部署网站到远程服务器
- 📊 **实时输出**：命令执行结果实时显示在界面上，支持中文输出

### 其他实用功能
- 🗂️ **分类和标签管理**：方便地为文章添加分类和多个标签
- 🖼️ **封面图片设置**：一键设置文章封面图片，自动复制到正确目录
- 📷 **图片管理**：支持插入图片，自动处理文件复制和路径引用
- 📱 **响应式界面**：支持窗口大小调整，适应不同屏幕尺寸
- 🔧 **自动依赖安装**：检测并自动安装缺失的 Python 依赖包

## 系统要求

- Windows 操作系统
- Python 3.6 或更高版本
- 已安装 Hexo 并配置好环境（全局或在当前项目中）
- 网络连接（用于首次启动时安装缺失依赖）

## 安装说明

### 方法一：直接下载（推荐）

1. 从 GitHub 仓库下载最新的发布版本
2. 将压缩包解压到 Hexo 博客项目的根目录下
3. 确保解压后的文件夹名为 `hexo_blog_manager`

### 方法二：手动克隆

```bash
# 进入您的 Hexo 博客项目根目录
cd your-hexo-blog

# 克隆本仓库到 hexo_blog_manager 文件夹
git clone https://github.com/your-username/hexo-blog-manager.git hexo_blog_manager
```

## 使用指南

### 启动程序

#### 方法一：双击启动（Windows）

直接双击 `hexo_blog_manager` 文件夹中的 `start.bat` 文件即可启动程序。

#### 方法二：命令行启动

打开命令提示符（CMD），进入程序目录，执行以下命令：

```cmd
cd hexo_blog_manager
python main.py
```

### 界面概览

程序界面主要分为三个区域：
- **左侧**：文章列表区域，显示所有文章的标题、日期和分类
- **右侧上部**：文章编辑区域，包括文章信息（标题、日期、分类、标签、封面）和内容编辑框
- **右侧下部**：工具栏和 Hexo 命令按钮区域

### 文章管理操作

#### 1. 新建文章
1. 点击左侧的"新建文章"按钮
2. 在右侧填写文章标题、日期（默认为当前日期）、分类和标签
3. 点击"选择图片"可设置文章封面
4. 在编辑区域编写文章内容
5. 点击"保存文章"按钮保存

#### 2. 编辑文章
1. 在文章列表中选择一篇文章
2. 点击"编辑文章"按钮或直接双击文章条目
3. 修改文章信息和内容
4. 点击"保存文章"按钮保存修改

#### 3. 删除文章
1. 在文章列表中选择一篇文章
2. 点击"删除文章"按钮
3. 在确认对话框中点击"是"确认删除

### Markdown 编辑功能

#### 使用工具栏

程序提供了丰富的 Markdown 编辑工具栏按钮，包括：

- **粗体**：将选中的文本转换为粗体格式 `**文本**`
- **斜体**：将选中的文本转换为斜体格式 `*文本*`
- **标题**：弹出对话框选择标题级别（1-6级）
- **引用**：添加引用格式 `> 文本`
- **分割线**：添加分割线 `---`
- **链接**：弹出对话框输入链接文本和 URL
- **插入图片**：选择本地图片插入
- **代码块**：插入代码块，可选择语言类型
- **预览**：在新窗口预览文章渲染效果
- **无序列表**：插入无序列表项 `- 文本`
- **有序列表**：插入有序列表项 `1. 文本`
- **表格**：弹出对话框输入行数和列数，自动生成表格
- **任务列表**：插入任务列表项 `- [ ] 任务`
- **删除线**：将选中的文本添加删除线 `~~文本~~`
- **代码行**：将选中的文本转换为行内代码 `` `文本` ``

#### 文本格式化技巧

- 工具栏按钮支持两种工作模式：
  - 如果有选中文本，将对选中的文本应用相应格式
  - 如果没有选中文本，将插入格式模板供您编辑
- 所有格式严格遵循 Markdown 标准语法，确保与 Hexo 完全兼容

### Hexo 命令操作

#### 启动本地服务器

1. 点击"启动本地服务器"按钮
2. 系统会自动检测端口 4000 是否被占用：
   - 如果端口可用，默认使用 4000 端口
   - 如果端口被占用，自动选择 4001-4010 范围内的可用端口
3. 在弹出的端口选择对话框中，您可以：
   - 接受推荐的可用端口
   - 手动输入其他端口号（必须在 1024-65535 范围内）
4. 点击"确定"按钮启动服务器
5. 服务器启动后，可以在浏览器中访问 `http://localhost:端口号` 查看效果
6. 命令输出区域会显示访问地址和停止方法提示

#### 其他 Hexo 命令

- **生成静态文件**：点击按钮直接执行 `hexo generate` 命令
- **清理缓存**：点击按钮直接执行 `hexo clean` 命令
- **部署网站**：点击按钮直接执行 `hexo deploy` 命令

所有命令的执行结果都会实时显示在界面底部的输出区域。

## 技术实现说明

### 代码结构

```
hexo_blog_manager/
├── main.py          # 主程序文件，包含所有功能实现
├── start.bat        # 快速启动脚本
└── README.md        # 项目说明文档
```

### 核心功能实现

1. **图形界面**：使用 Tkinter 库构建响应式 GUI 界面
2. **文件操作**：通过 Python 文件系统 API 读写 Hexo 文章文件
3. **命令执行**：使用 subprocess 模块在独立线程中执行 Hexo 命令
4. **端口检测**：使用 socket 库检测端口占用情况
5. **Markdown 渲染**：使用 markdown 库实现文章预览功能
6. **路径处理**：自动处理 Hexo 项目路径和资源文件复制

### 关键代码模块

- `HexoBlogManager` 类：程序的主类，管理所有 UI 组件和业务逻辑
- `create_ui()` 方法：创建程序的图形界面
- `load_posts()`, `save_post()`, `delete_post()` 等：文章管理相关方法
- `format_text()` 和各种 `insert_xxx()` 方法：Markdown 编辑功能
- `run_hexo_command()` 和 `_execute_command()`：Hexo 命令执行功能
- `start_server_with_port()`：自定义端口选择功能
- `is_port_in_use()`：端口占用检测功能

## 常见问题解决

### 端口被占用

如果启动服务器时提示端口被占用，可以通过程序提供的端口选择功能选择其他可用端口，无需手动修改 Hexo 配置。

### 依赖缺失

程序会自动检测并安装缺失的 Python 依赖包（如 markdown 库），如果自动安装失败，可以手动安装：

```cmd
pip install markdown
```

### 命令执行失败

如果 Hexo 命令执行失败，请检查：
1. Hexo 是否已正确安装并配置环境变量
2. 程序是否位于 Hexo 博客项目的根目录下
3. 命令输出区域的错误信息，针对性解决问题

## 开源协议

本项目采用 MIT 开源协议 - 查看 [LICENSE](LICENSE) 文件了解详情

## 贡献指南

欢迎贡献代码或提出建议！如果您有任何问题或改进意见，请在 GitHub 仓库提交 Issue 或 Pull Request。

## Acknowledgments

- Hexo - 优秀的静态博客生成器
- Python - 强大的编程语言
- Tkinter - 简洁的 GUI 库

---

希望这个工具能帮助您更高效地管理 Hexo 博客！如有任何问题，请随时联系项目维护者。

<p align="center">
  Made with ❤️ for Hexo users
</p>